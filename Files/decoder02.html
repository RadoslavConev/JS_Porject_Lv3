<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Caesar Cipher Decoder 0.1.6</title>
	<!-- <script src="caesar_logic.js" type="application/javascript"></script> -->
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
</head>
<body>
	<h3>This is Caesar Cipher Decoder made by Radoslav Conev.</h3>
	<h4>Instructions: Place your text in the text field belloew. Then click "Decode" Button. If everithing is okay the result taht is the most likely to be corect will appear. If its not you can view whole table of results which is organaised that way: "shift:result".</h4>
	<div id='input_form' class="">
		<form class="row row-cols-lg-auto g-3 align-items-center">
			<div class="position-absolute top-50 start-50">
				<input type="text" name="txtinput" id=txtinput class="form-control"></input>
			</div>
			<div>
				<button type="submit" id=txtinput_btn class="btn btn-warning text-center  btn-block" onclick="decodinger()">Decode</button>
			</div>
		</form>
	</div>

<script type="text/javascript">
var alphabet = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']; //26
var input_split = [];
var input_split_default = [];
var input;
var mostFrequent = null;
var counts = { };
var indexOfMostCommon;
var displcE;
var inE;
var displcT;
var inT;
var displcH;
var inH;
var newText = [];
var allVariants = {};

function decodinger (e) {
	document.getElementById("input_form").addEventListener("click", function(event){
    	event.preventDefault() 
	});

	input = document.getElementById('txtinput').value;
	input_split_default = input.split('');
	//console.log(input_split_default);
	// console.log(input)
	input = input.toLowerCase();
	// console.log(input)
	input_split = input.split('');
	// console.log(input_split)
	var previous = 1;
	let letters = {};



		//count letters
for( let i = 0; i < input_split.length; i++){
	// console.log( input_split[i])
	var curLetter = input_split[i];
	if( letters[curLetter] ){
		letters[curLetter] ++
	} else {
		letters[curLetter] = 1;
	}
}



		//most common letter
let max = 1;
let letter = '';
for (const [key, value] of Object.entries(letters)) {
  console.log(`${key}: ${value}`);
  if( value > max ){
  	max = value; letter = key;
  }
}
console.log(letter)




		//displ`s
if ( ( 4 - alphabet.indexOf(letter) ) > 0 ){	
	inE = 4 - alphabet.indexOf(letter);
	//console.log(alphabet.indexOf(letter))
	//console.log(inE)
} else if ( ( 4 - alphabet.indexOf(letter) ) < 0 ){
	inE = 25 + ( 4 - alphabet.indexOf(letter) );
	//console.log( 4 - alphabet.indexOf(letter))
	//console.log(inE)
} else {
	inE = 0;
	//console.log(inE)
}
displcE = alphabet[inE];

if ( ( 19 - alphabet.indexOf(letter) ) > 0 ){	
	inT = 19 - alphabet.indexOf(letter);
	//console.log(alphabet.indexOf(letter))
	//console.log(inE)
} else if ( ( 19 - alphabet.indexOf(letter) ) < 0 ){
	inT = 25 + ( 19 - alphabet.indexOf(letter) );
	//console.log( 4 - alphabet.indexOf(letter))
	//console.log(inT)
} else {
	inT = 0;
	//console.log(inT)
}
displcT = alphabet[inT];

if ( ( 7 - alphabet.indexOf(letter) ) > 0 ){	
	inH = 7 - alphabet.indexOf(letter);
	//console.log(alphabet.indexOf(letter))
	//console.log(inH)
} else if ( ( 7 - alphabet.indexOf(letter) ) < 0 ){
	inH = 25 + ( 7 - alphabet.indexOf(letter) );
	//console.log( 7 - alphabet.indexOf(letter))
	//console.log(inH)
} else {
	inH = 0;
	//console.log(inH)
}
displcH = alphabet[inH];





		//calc all variants
//var allVariants = {};
for (var l = 0; l < 26; l++) {
	let currStr = '';
	for (var b = 0; b < input_split.length; b++) {
		let currSymbol = input_split[b];
		if ( alphabet.indexOf(currSymbol) > -1 ) {
			if ( ( alphabet.indexOf(currSymbol) + l) <= 25 ) {
				//console.log((alphabet.indexOf(currSymbol) + l), 'first if')
				if ( input_split_default[b] == input_split_default[b].toUpperCase() ) {
					currStr += alphabet[alphabet.indexOf(currSymbol) + l].toUpperCase();
				} else {
					currStr += alphabet[alphabet.indexOf(currSymbol) + l];
				}
			} else if ( (alphabet.indexOf(currSymbol) + l) > 25) {
			//console.log('second if')
				let newIndex = (alphabet.indexOf(currSymbol) + l) - 26;
				if ( input_split_default[b] == input_split_default[b].toUpperCase() ) {
					currStr += alphabet[newIndex].toUpperCase();
				} else {
					currStr += alphabet[newIndex];
				}
			}
		} else {
			currStr += currSymbol;
		}
		allVariants[l] = currStr;
	}
}
for (const [key, value] of Object.entries(allVariants)) {
  console.log(`${key}: ${value}`);
}

		//Results
// function showResults() {
// 	for (var r = 0; r < 25; r++) {
// 		liElement = document.createElement('li');
// 		liElement.setAttribute('value', allVariants[displcH]);
// 	}
// }

for (var r = 0; r < 26; r++) {
		liElement = document.createElement('li');
		liElement.innerText = r + ': ' + allVariants[r];
		liElement.setAttribute('class', "list-group-item");
		document.getElementById("fullList").appendChild(liElement);
	}


// console.log( letter)
//e, t, h

// console.log( alphabet.indexOf('e'))
// console.log( alphabet.indexOf('t'))
// console.log( alphabet.indexOf('h'))
// console.log( alphabet.indexOf(letter))
// console.log( alphabet.indexOf(letter) - alphabet.indexOf('e') )
// console.log( alphabet.indexOf(letter) - alphabet.indexOf('t') )
// console.log( alphabet.indexOf(letter) - alphabet.indexOf('h') )
// for(var o = 0; o < 26; o++){
// 	for(var j = 0; j < input.length; j++){
// 		console.log(j);
// 		var currLetter = input_split[j];
// 		console.log(currLetter);
// 		var currLetIndex = alphabet.indexOf(currLetter);
// 		newText[o] += alphabet[currLetIndex + o];
// 		console.log(newText);

// 	}
// }

			//most common letter
 	// for(var i = 0; i < input_split.length; i++){
		// var letter = input_split[i];
			
		// if(counts[letter] === undefined){
  //          	counts[letter] = 1;
  //      	}else{
  //          	counts[letter] = counts[letter] + 1;
  //      	}

  //      	if(counts[letter] > previous){
  //           previous = counts[letter];
  //           mostFrequent = input_split[i];
  //      	}
  //   }


// console.log(newText);
// return newText[3];
}

// function show (){
// 	document.getElementById('show').innerHTML = decodinger();
// }

// function showResults() {
// 	for (var r = 0; r < 25; r++) {
// 		liElement = document.createElement('li');
// 		liElement.setAttribute('innerText', allVariants[displcH]);
// 		document.getElementById("mostLikely").appendChild(liElement);
// 	}
// }

// function showFullTable() {
// 	document.getElementById("full_table_btn").addEventListener("click", function(event){
//   event.preventDefault()
// });
// 	document.getElementById('fullTable').setAttribute('visible', '');
// }
// console.log(document.getElementById('fullList'))



</script>


	
<button type="submit" onclick="showFullTable()" id='full_table_btn' class="btn btn-warning">Show</button>
<!-- <div id=show ></div> -->
<h3>Most likely results:</h3>
<div id="mostLikelyTable">
	<ul id="mostLikely" class="list-group">
		<!-- <li class="list-group-item"></li> -->
	</ul>
</div>
<div id="fullTable" style="display:none">
	<ul id="fullList" class="list-group">
		<!-- <li class="list-group-item">yt</li> -->
	</ul>
</div>



<script type="text/javascript">
function showFullTable() {
	document.getElementById("full_table_btn").addEventListener("click", function(event){
		event.preventDefault()
});
document.getElementById('fullTable').setAttribute('style', 'display:inline');
}
console.log(document.getElementById('fullList'))

</script>


</body>
</html>